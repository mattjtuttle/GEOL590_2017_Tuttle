---
title: "Task 08 - R Notebook"
output:
  html_document:
    keep_md: TRUE
  html_notebook: default
---

# Introduction

This R Markdown Notebook has been created for as part of Task 08 for the course GEOL 590. This task is an introduction to functions, flow control, and error handling.

# Tasks

## Function tasks
* Complete this task by creating an R notebook (.Rmd file) and accompanying .md file

## Functions and error handling:
Write a function that fulfills the following criteria:

* It should be tidyverse compatible (i.e., the first argument must be a data frame)
* It should add two arbitrary columns of the data frame (specified by the user) and put them in a new column of that data frame, with the name of the new column specified by the user
* It should throw an informative warning if any invalid arguments are provided. Invalid arguments might include:
    * The first argument is not a data frame
    * Less than two valid columns are specified to add (e.g., one or both of the column names isn't in the supplied data frame) 
    * The columns specified are not numeric, and therefore can't be added - use `tryCatch()` for this
* If the columns to add aren't valid but the new column name is, the function should create a column of NA values

```{r}
library(tidyverse) #Loads the packages associated with the tidyverse

#Creates a function that adds two columns in a dataframe as specified above
column_addition <- function(df, col1, col2, name){
  
  #Checks that the first argument is a dataframe
  if(is.data.frame(df) != TRUE)
    stop("The first argument is not a dataframe.")
  
  #Checks that two valid columns were input as arguments for the function
  `%!in%` <- function(x,y){!(`%in%`(x,y))} #Creates a "not in" operator
  if(col1 %!in% colnames(df) | col2 %!in% colnames(df))
    warning("One (or both) of the columns was not found in the specified dataframe.")
  
  #Checks that both columns specified are numeric
  #"[[]]" not "$" notation required for selecting column names as arguments
  tryCatch(
    if(is.numeric(df[[col1]]) != TRUE | is.numeric(df[[col2]]) != TRUE){
    warning("One of the specified columns is not numeric.")
  }
  )
  
  #Adds two columns and places the output in a new column within the existing dataframe
  add_col <- lazyeval::interp(~ a + b, a = as.name(col1), b = as.name(col2))
  df %>% mutate_(.dots = setNames(list(add_col), name)) #Needed to use standard evaluation functions

}

#Inculded to test code in development
test1 <- column_addition(mtcars, "mpg", "cyl", "added_values")

```


## Loop and performance metric tasks
* Write a function named `my_sum` that uses a for loop to calculate the sum of the elements of a vector, which is passed as an argument (i.e., it should do the same thing that `sum()` does with vectors). `your_fun(1:10^4)` should return 50005000.
* Use the `microbenchmark::microbenchmark` function to compare the performace of your function to that of `sum` in adding up the elements of the vector `1:10^4`. The benchmarking code should look something like:
```
test.vec <- 1:10^4
microbenchmark(
    my_sum(test.vec),
    sum(test.vec)
    )
```
Is there a difference? Why?

```{r}

#Does the same thing as the sum() function using a for loop
my_sum <- function(vec){
  adding.vector <- 0
  for (num in vec){
    adding.vector = adding.vector + num
  }
  return(adding.vector)
}

#Compares the functions of sum() and my_sum()
test.vec <- 1:10^4
microbenchmark::microbenchmark(
  my_sum(test.vec),
  sum(test.vec)
)

#Included to test code development
test2 <- my_sum(1:10^4)
test3 <- sum(1:10^4)
print(test2)
print(test3)

```

One difference between the `sum()` function and the `my_sum` function, as indicated by the microbenchmark test, is that the for loop of `my_sum` takes more computing time to calculate its sum when compare the `sum()` function. This is due to the fact that for loops are inherently slow and the `sum()` function of base R has been optimized for speed. Additionally, in the example code given above, the `sum()` function is able to work with and return an integer while the `my_sum()` function must return a double.